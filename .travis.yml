language: bash

sudo: 'required'

notifications:
  email:
    on_success: always
  slack:
    secure: awXlK4UI3wT1lSjP7D6pnRagQeCadJC9D7KqxNZqeOZkazOKy8cgXfuKVGbGk3PMdWvOb1G38Pp+NXvBqoJgp+4KEiI8gaKlvDPc74izPw8EsG8PvdcuDmj4WMi/jg7vir/X3Om9LeEUCpAWCZXK6al1mfQLZM45MileVNXi9DARsZTGcSP2/a6hlPEiE+b8WeQh7NywDBSi0cwtmL/Y8vzjf7L8cLIZxag1F+eKzCMApJaPJKaOwLeuOiJdO+PeOFtsbvBv+zA4rQ8XQLEMt8mocoe3a16nr3YhHmIf1ZSwqBAjtD1Qbg4k3jv+SGrfAxoYFOQhWSKK3mgcsRgZHyl5Hzf1u/fSXpiTAXPoMAidGgutLhmJPZlV8Y1cgIHd9lGu2qXb5iEQMtaJUuypA6BsTNsK+/96yjqbjAbffuLYOqiI8jWjeyOck9dcfgoA1VnPimiODnunZpyMOB2DfZ4cFlOk5qoK/qutEdEaTdieD13gaY+O7mqqwdp7cgjFN4linsGffKgXFlipU9IIOVGUCihV8TfVIip4/LIpl2VJvsO6KFTQrshDY+tkMMUkHIy0Zp/RAL50fyICp+7e4XhM5oyemd9/rq+WTa4qPSGuCMZNC3mXcXsKRt82/qoiCqeyiDQalU03fX+rueKZO7hfNj4RNjB1F9ZMtH5j9Cg=
    on_success: always

services:
  - docker

env:
  - DOCKER_COMPOSE_VERSION=1.25.0

before_install:
  - chmod +x ./.travis/main.sh
  - ./.travis/main.sh

install:
  - git clone https://github.com/litespeedtech/ols-docker-env.git
  - docker-compose build --no-cache
  - docker-compose up -d

before_script:
  - docker image ls
  - sleep 15

script:  
  - curl -Ik http://localhost:80/
  - curl -Ik http://localhost:443/

after_success:
  - echo "${DOCKER_PASSWORD}" | docker login -u "${DOCKER_USERNAME}" --password-stdin
  - docker-compose push litespeed/openlitespeed-beta

after_script:
  - docker-compose stop
  - docker-compose rm -f





