language: bash

sudo: 'required'

notifications:
  email:
    on_success: always
  slack:
    rooms:
      - secure: Ql0I1YE58yDaMWk80g8cwhRE+/F5c0XBY3xslcb69eWugucFUhwc+g0MraFee21Fo46TxSNIowFZyNarv3TsHKfZbIcQyCNmZqDeAiYyxW9OsdezTY8MvaSdygLKyLSI+ynG6w3iUEjMmX7fqRRTwqx9EzKxSBSuhn5ocSTkff4ajkk8GIWEsOR0S8cCEdtSsBvGmsn2BQtkt31PjB6icUqds/aClYU7r7DSqnHQNZoUh2Aj/Hd94zU2OKSiJPrEHln5NJqcuamRbhWF/B4H1+LG/wiqr9waK8cl8F4+ghhGQMRQbIA1x/44SIev+GC+3MpqAGZOXJVtWhWey7v961Hr6oykqBFY3UXWfbH/NjAeGIa/tnLeEG+UgGksQpQW56zjiGe6lC/5onOG0rZaodmSoJ/JHobukrptXUC73R1GkpACX1YDyWutcAZBFXzmxN+7x1DVzxB+xxBoqLZp6Vm/9jzKhkECbaK6a1l+52aRKWyQhLAdx0Fu8eLQulIDObgvZ+whOtcgus5HBF5EbP8DnAPHZByWV0FryYWwLhl0WFQJP/Wb74IgR3aUIWDLY9oxhryxS4iNlOZAu4Jn83WRcJTi1RKA0T4cobstOR/uqRLA3Qi83zW6Lc6gY/m3j8xbsUZYMQYC3E/d+K6POItCASXbpDQ2zi9YkO38X/I=
    on_success: always

services:
  - docker

env:
  - DOCKER_COMPOSE_VERSION=1.25.0

before_install:
  - chmod +x ./.travis/main.sh
  - ./.travis/main.sh

install:
  - git clone https://github.com/litespeedtech/ols-docker-env.git
  - docker-compose build --no-cache
  - docker-compose up -d

before_script:
  - docker image ls
  - sleep 15

script:  
  - curl -Ik http://localhost:80/
  - curl -Ik http://localhost:443/

after_success:
  - echo "${DOCKER_PASSWORD}" | docker login -u "${DOCKER_USERNAME}" --password-stdin
  - docker-compose push litespeed/openlitespeed-beta

after_script:
  - docker-compose stop
  - docker-compose rm -f





