language: bash

sudo: 'required'

notifications:
   slack:
    secure: "IPScSSZXHdCwLZ4mDIEiXwR1TCS3mp3qIw8IyvwrijZZSBGPGWxud/otawOOrU8fGqK7USBJLLTvzieRjhpiWx778wuGBpL+lgxdBoIZmlHddHFtTeTTH/ysYH13z+W4DeJ7lN/izpmClH9YkWvGlz+AkVhsmVF333xNPXweOdT7DudaDHlJUjtqAvZ9BvBdxlGmHkOIm50xoipEb+mPoP9CR+eFcsvWqZwvsmfulWDNnqjwEf4E5wNtC4QUxPAUcDMkSCGACBVSFAJ8ZprQDJ2XKD87JseH4rpXsnOkf2Qn2lxJLbgKnG3azUWNnInVkcnPVD0iNUDf0GeHrzNlvzlWhJPHHpBsXFbLD+SpLViKcqPuqNa9wWYlJehUReoowTyxSbwbL3CaMxJE6ljOQnEdCLlFFHlIDKk0Muy0Z0lscVqTTwPv7B98mIWtvcIUKpKT39X+CP01bCtn9yXLBvuiVe4/O869a8q6P44I8wGDSUzSN8BPZJw7EXMBWxTulVh9EiOahlCdTZTHkemAX8zeflQPfTbfuaDKqlUqJ2c7TkNLxxWCNhnt4c9O73G9dk0WSfA1fCMGm23nKx/7FR9pY3/+nKz2e2g/oa3LfDEtUB5bvilx3WXhVYWGUHuwxGFk5UxPJ4MlKDWlel4tRewc5o4ccK2/0UyfpvFae8o="
    on_success: always

services:
  - docker

env:
  - DOCKER_COMPOSE_VERSION=1.25.0

before_install:
  - chmod +x ./.travis/main.sh
  - ./.travis/main.sh

install:
  - git clone https://github.com/litespeedtech/ols-docker-env.git
  - docker-compose build --no-cache
  - docker-compose up -d

before_script:
  - docker image ls
  - sleep 15

script:  
  - curl -Ik http://localhost:80/
  - curl -Ik http://localhost:443/

after_success:
  - echo "${DOCKER_PASSWORD}" | docker login -u "${DOCKER_USERNAME}" --password-stdin
  - docker-compose push litespeed/openlitespeed-beta

after_script:
  - docker-compose stop
  - docker-compose rm -f





